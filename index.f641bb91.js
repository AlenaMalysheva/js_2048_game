const t=new class{constructor(t=null){this.boardSize=4,this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){let t=[];for(let e=0;e<this.boardSize;e++)t.push(Array(this.boardSize).fill(0));return t}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<this.boardSize;e++){let s=this.compressRow(this.board[e]);this.board[e].toString()!==s.toString()&&(t=!0,this.board[e]=s)}t&&(this.addRandomTile(),this.isGameOver()?this.status="lose":this.isWin()&&(this.status="win"))}moveRight(){this.board=this.board.map(t=>t.reverse()),this.moveLeft(),this.board=this.board.map(t=>t.reverse())}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){"idle"===this.status&&(this.score=0,this.status="playing",this.board=this.createEmptyBoard(),this.addRandomTile(),this.addRandomTile())}restart(){this.status="idle",this.board=this.createEmptyBoard(),this.score=0,this.start()}addRandomTile(){let t=[];for(let e=0;e<this.boardSize;e++)for(let s=0;s<this.boardSize;s++)0===this.board[e][s]&&t.push({x:e,y:s});if(t.length>0){let{x:e,y:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}compressRow(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>0!==t);e.length<this.boardSize;)e.push(0);return e}transpose(){let t=this.createEmptyBoard();for(let e=0;e<this.boardSize;e++)for(let s=0;s<this.boardSize;s++)t[e][s]=this.board[s][e];this.board=t}isWin(){return this.board.flat().includes(2048)}isGameOver(){if(this.board.flat().includes(0))return!1;for(let t=0;t<this.boardSize;t++)for(let e=0;e<this.boardSize-1;e++)if(this.board[t][e]===this.board[t][e+1]||this.board[e][t]===this.board[e+1][t])return!1;return!0}},e=document.querySelector(".game-score"),s=document.querySelector(".start"),r=document.querySelector(".message-start"),i=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),a=Array.from(document.querySelectorAll(".field-cell"));function d(){let s=t.getState();e.textContent=t.getScore(),a.forEach((t,e)=>{let r=s[Math.floor(e/4)][e%4];t.textContent=r>0?r:"",t.className="field-cell",r>0&&t.classList.add(`field-cell--${r}`)}),"win"===t.getStatus()?i.classList.remove("hidden"):"lose"===t.getStatus()&&o.classList.remove("hidden")}document.addEventListener("keydown",e=>{if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}d()}}),s.addEventListener("click",function(){t.start(),r.classList.add("hidden"),i.classList.add("hidden"),o.classList.add("hidden"),s.textContent="Restart",s.classList.add("restart"),s.classList.remove("start"),d()}),s.addEventListener("click",function(){t.restart(),d()});
//# sourceMappingURL=index.f641bb91.js.map
